{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/yesdevnull/tf-version-bump/schema/config.json",
  "title": "tf-version-bump Configuration",
  "description": "Configuration file for tf-version-bump to specify Terraform module version updates",
  "type": "object",
  "required": ["modules"],
  "properties": {
    "modules": {
      "type": "array",
      "description": "List of Terraform modules to update",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["source", "version"],
        "properties": {
          "source": {
            "type": "string",
            "description": "The module source identifier. Can be a registry module, local path, or Git URL",
            "minLength": 1,
            "examples": [
              "terraform-aws-modules/vpc/aws",
              "terraform-aws-modules/iam/aws//modules/iam-user",
              "./modules/networking",
              "../shared-modules/database",
              "git::https://github.com/example/terraform-modules.git//vpc"
            ]
          },
          "version": {
            "type": "string",
            "description": "Target version to update the module to. Supports full SemVer 2.0.0 specification including pre-release and build metadata",
            "minLength": 1,
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(-[0-9A-Za-z-]+(\\.[0-9A-Za-z-]+)*)?(\\+[0-9A-Za-z-]+(\\.[0-9A-Za-z-]+)*)?$",
            "examples": [
              "5.0.0",
              "1.2.3",
              "10.15.2",
              "2.0.0-alpha",
              "1.0.0-beta.1",
              "3.5.0-rc.2+build.123",
              "4.1.0+20240115"
            ]
          },
          "from": {
            "oneOf": [
              {
                "type": "string",
                "description": "Single version to update from. Supports full SemVer 2.0.0 specification including pre-release and build metadata",
                "minLength": 1,
                "examples": [
                  "4.0.0",
                  "~> 3.0"
                ]
              },
              {
                "type": "array",
                "description": "List of versions to update from. Module will be updated if current version matches any in this list",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "examples": [
                  ["3.0.0", "~> 3.0"],
                  ["4.0.0", "4.1.0"]
                ]
              }
            ],
            "description": "Optional: Only update the module if its current version matches this value or any value in the list. Supports version constraints like ~> 3.0"
          },
          "ignore_versions": {
            "oneOf": [
              {
                "type": "string",
                "description": "Single version to skip during updates",
                "minLength": 1,
                "examples": [
                  "3.14.0",
                  "~> 3.0"
                ]
              },
              {
                "type": "array",
                "description": "List of versions to skip during updates. Module will be skipped if current version matches any in this list",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "examples": [
                  ["3.0.0", "~> 3.0"],
                  ["3.14.0", "4.0.0"]
                ]
              }
            ],
            "description": "Optional: Skip modules currently at these versions. Takes precedence over 'from' filter"
          },
          "ignore_modules": {
            "type": "array",
            "description": "Optional: List of module names or patterns to ignore. Supports wildcard matching using '*' for zero or more characters",
            "items": {
              "type": "string"
            },
            "examples": [
              ["vpc", "legacy-*"],
              ["test-*", "*-deprecated"],
              ["prod-vpc", "staging-*", "*-old"]
            ]
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "modules": [
        {
          "source": "terraform-aws-modules/vpc/aws",
          "version": "5.0.0"
        }
      ]
    },
    {
      "modules": [
        {
          "source": "terraform-aws-modules/vpc/aws",
          "version": "5.0.0",
          "from": "4.0.0"
        },
        {
          "source": "terraform-aws-modules/s3-bucket/aws",
          "version": "4.0.0"
        }
      ]
    },
    {
      "modules": [
        {
          "source": "terraform-aws-modules/vpc/aws",
          "version": "5.0.0",
          "ignore_modules": ["legacy-vpc", "test-*"]
        },
        {
          "source": "terraform-aws-modules/s3-bucket/aws",
          "version": "4.0.0",
          "from": ["3.0.0", "~> 3.0"],
          "ignore_modules": ["*-deprecated"]
        }
      ]
    },
    {
      "modules": [
        {
          "source": "terraform-aws-modules/vpc/aws",
          "version": "5.0.0",
          "ignore_versions": ["3.14.0", "~> 3.0"]
        }
      ]
    }
  ]
}
